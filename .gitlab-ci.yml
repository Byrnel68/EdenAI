image: node:18-slim

pages:
  stage: deploy
  script:
    # node:18-slim should have npm, but let's verify and install if needed
    - |
      if ! command -v npm > /dev/null 2>&1; then
        echo "npm not found, installing..."
        apt-get update -qq
        apt-get install -y -qq npm
      fi
    - npm --version
    - node --version
    - npm ci --prefer-offline --no-audit
    - npm run build
    - ls -la out/
    - mv out public
  artifacts:
    paths:
      - public
  only:
    - main
