# Try multiple approaches - GitLab will use the first available
image: node:18

pages:
  stage: deploy
  script:
    # Check if we're in Docker or shell runner
    - |
      if command -v npm &> /dev/null; then
        echo "npm found in PATH"
        npm --version
      elif [ -f /usr/bin/npm ]; then
        echo "npm found at /usr/bin/npm"
        /usr/bin/npm --version
      elif [ -f /usr/local/bin/npm ]; then
        echo "npm found at /usr/local/bin/npm"
        /usr/local/bin/npm --version
      else
        echo "Installing npm..."
        apt-get update -qq && apt-get install -y -qq npm
      fi
    - npm ci
    - npm run build
    - mv out public
  artifacts:
    paths:
      - public
  only:
    - main
